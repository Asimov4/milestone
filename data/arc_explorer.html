<!doctype html>
<html ng-app>
  <head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>
    <script src="https://c9.io/asimov4/milestonegsy/workspace/data/data.js"></script>
    <script>
        function TodoCtrl($scope) {
          $scope.topHits = {};
         
          $scope.addTodo = function() {
            var bigjsonblob = window.bigjsonblob;
            // Industry
            var aggregate = {};
            $.each(bigjsonblob.results,function(i,e) { 
               if (!(e.raw.industry in aggregate)) {
                  aggregate[e.raw.industry] = 1;
               } else {
                  aggregate[e.raw.industry] ++;
               }
            });
            
            var topValues = [];
            $.each(aggregate,function(i,e) { 
               topValues.push({name: i, count: e});
            });
            
            topValues = topValues.sort(function(a,b) { return b.count - a.count});
            
            $scope.topHits["industries"] = topValues;
          };
        }
                
    </script>
    <link rel="stylesheet" href="todo.css">
  </head>
  <body>
    <h2>Todo</h2>
    <div ng-controller="TodoCtrl">
      <ul class="unstyled">
        <li ng-repeat="hit in topHits.industries">
          <span>{{hit.name}} {{hit.count}}</span>
        </li>
      </ul>
      <form ng-submit="addTodo()">
        <input class="btn-primary" type="submit" value="Process">
      </form>
    </div>
  </body>
</html>